#!/bin/bash

test_ips="10.10.11.1,10.10.11.2,10.10.11.3,10.10.11.4,10.10.11.5,10.10.11.6,10.10.11.7,10.10.11.8,10.10.11.9,10.10.11.10,10.10.11.11,10.10.11.12,10.10.11.13,10.10.11.14,10.10.11.15,10.10.11.16,10.10.11.17,10.10.11.18,10.10.11.19,10.10.11.20,10.10.12.1,10.10.12.2,10.10.12.3,10.10.12.4,10.10.12.5,10.10.12.6,10.10.12.7,10.10.12.8,10.10.12.9,10.10.12.10,10.10.12.11,10.10.12.12,10.10.12.13,10.10.12.14,10.10.12.15,10.10.12.16,10.10.12.17,10.10.12.18,10.10.12.19,10.10.12.20,10.10.13.1,10.10.13.2,10.10.13.3,10.10.13.4,10.10.13.5,10.10.13.6,10.10.13.7,10.10.13.8,10.10.13.9,10.10.13.10,10.10.13.11,10.10.13.12,10.10.13.13,10.10.13.14,10.10.13.15,10.10.13.16,10.10.13.17,10.10.13.18,10.10.13.19,10.10.13.20,10.10.14.1,10.10.14.2,10.10.14.3,10.10.14.4,10.10.14.5,10.10.14.6,10.10.14.7,10.10.14.8,10.10.14.9,10.10.14.10,10.10.14.11,10.10.14.12,10.10.14.13,10.10.14.14,10.10.14.15,10.10.14.16,10.10.14.17,10.10.14.18,10.10.14.19,10.10.14.20,10.10.21.1,10.10.21.2,10.10.21.3,10.10.21.4,10.10.21.5,10.10.21.6,10.10.21.7,10.10.21.8,10.10.21.9,10.10.21.10,10.10.21.11,10.10.21.12,10.10.21.13,10.10.21.14,10.10.21.15,10.10.21.16,10.10.21.17,10.10.21.18,10.10.21.19,10.10.21.20,10.10.22.1,10.10.22.2,10.10.22.3,10.10.22.4,10.10.22.5,10.10.22.6,10.10.22.7,10.10.22.8,10.10.22.9,10.10.22.10,10.10.22.11,10.10.22.12,10.10.22.13,10.10.22.14,10.10.22.15,10.10.22.16,10.10.22.17,10.10.22.18,10.10.22.19,10.10.22.20,10.10.23.1,10.10.23.2,10.10.23.3,10.10.23.4,10.10.23.5,10.10.23.6,10.10.23.7,10.10.23.8,10.10.23.9,10.10.23.10,10.10.23.11,10.10.23.12,10.10.23.13,10.10.23.14,10.10.23.15,10.10.23.16,10.10.23.17,10.10.23.18,10.10.23.19,10.10.23.20,10.10.24.1,10.10.24.2,10.10.24.3,10.10.24.4,10.10.24.5,10.10.24.6,10.10.24.7,10.10.24.8,10.10.24.9,10.10.24.10,10.10.24.11,10.10.24.12,10.10.24.13,10.10.24.14,10.10.24.15,10.10.24.16,10.10.24.17,10.10.24.18,10.10.24.19,10.10.24.20,10.10.25.1,10.10.25.2,10.10.25.3,10.10.25.4,10.10.25.5,10.10.25.6,10.10.25.7,10.10.25.8,10.10.25.9,10.10.25.10,10.10.25.11,10.10.25.12,10.10.25.13,10.10.25.14,10.10.25.15,10.10.25.16,10.10.25.17,10.10.25.18,10.10.25.19,10.10.25.20,10.10.111.1,10.10.111.2,10.10.111.3,10.10.111.4,10.10.111.5,10.10.111.6,10.10.111.7,10.10.111.8,10.10.111.9,10.10.111.10,10.10.111.11,10.10.111.12,10.10.111.13,10.10.111.14,10.10.111.15,10.10.111.16,10.10.111.17,10.10.111.18,10.10.111.19,10.10.111.20,10.10.112.1,10.10.112.2,10.10.112.3,10.10.112.4,10.10.112.5,10.10.112.6,10.10.112.7,10.10.112.8,10.10.112.9,10.10.112.10,10.10.112.11,10.10.112.12,10.10.112.13,10.10.112.14,10.10.112.15,10.10.112.16,10.10.112.17,10.10.112.18,10.10.112.19,10.10.112.20,10.10.113.1,10.10.113.2,10.10.113.3,10.10.113.4,10.10.113.5,10.10.113.6,10.10.113.7,10.10.113.8,10.10.113.9,10.10.113.10,10.10.113.11,10.10.113.12,10.10.113.13,10.10.113.14,10.10.113.15,10.10.113.16,10.10.113.17,10.10.113.18,10.10.113.19,10.10.113.20,10.10.121.1,10.10.121.2,10.10.121.3,10.10.121.4,10.10.121.5,10.10.121.6,10.10.121.7,10.10.121.8,10.10.121.9,10.10.121.10,10.10.121.11,10.10.121.12,10.10.121.13,10.10.121.14,10.10.121.15,10.10.121.16,10.10.121.17,10.10.121.18,10.10.121.19,10.10.121.20,10.10.122.1,10.10.122.2,10.10.122.3,10.10.122.4,10.10.122.5,10.10.122.6,10.10.122.7,10.10.122.8,10.10.122.9,10.10.122.10,10.10.122.11,10.10.122.12,10.10.122.13,10.10.122.14,10.10.122.15,10.10.122.16,10.10.122.17,10.10.122.18,10.10.122.19,10.10.122.20,10.10.123.1,10.10.123.2,10.10.123.3,10.10.123.4,10.10.123.5,10.10.123.6,10.10.123.7,10.10.123.8,10.10.123.9,10.10.123.10,10.10.123.11,10.10.123.12,10.10.123.13,10.10.123.14,10.10.123.15,10.10.123.16,10.10.123.17,10.10.123.18,10.10.123.19,10.10.123.20,10.10.124.1,10.10.124.2,10.10.124.3,10.10.124.4,10.10.124.5,10.10.124.6,10.10.124.7,10.10.124.8,10.10.124.9,10.10.124.10,10.10.124.11,10.10.124.12,10.10.124.13,10.10.124.14,10.10.124.15,10.10.124.16,10.10.124.17,10.10.124.18,10.10.124.19,10.10.124.20,10.10.125.1,10.10.125.2,10.10.125.3,10.10.125.4,10.10.125.5,10.10.125.6,10.10.125.7,10.10.125.8,10.10.125.9,10.10.125.10,10.10.125.11,10.10.125.12,10.10.125.13,10.10.125.14,10.10.125.15,10.10.125.16,10.10.125.17,10.10.125.18,10.10.125.19,10.10.125.20"


# Correctly escaped command
command="ip addr | awk '\$1 ~ /^[0-9]+:/ { if (iface != \"\" && mac != \"\") print iface\": \"mac; iface = \$2; sub(/:$/, \"\", iface); mac = \"\" } \$1 == \"link/ether\" { mac = \$2 } END { if (iface != \"\" && mac != \"\") print iface\": \"mac }'"

# Pass the command to execute_on_machines.sh
./execute_on_machines.sh "$test_ips" "$command"
